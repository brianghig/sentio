/*! sentio Version: 0.3.1 */
angular.module("sentio",[]),angular.module("sentio.realtime",[]),angular.module("sentio.realtime").directive("sentioRtTimeline",function($document,$window,$timeout,$log){"use strict";return{restrict:"A",scope:{model:"=sentioModel",markers:"=sentioMarkers",markerHover:"=sentioMarkerHover",interval:"=sentioInterval",delay:"=sentioDelay",yExtent:"=sentioYExtent",fps:"=sentioFps",resizeWidth:"@sentioResizeWidth",resizeHeight:"@sentioResizeHeight",configure:"&sentioConfigureFn"},replace:!1,link:function(scope,element,attrs,controller){var timelineElement=d3.select(element[0]),timeline=sentio.realtime.timeline(),width=element[0].style.width;null!=width&&""!==width&&(width=parseFloat(width.substring(0,width.length-2)),null==width||Number.isNaN(width)||timeline.width(width));var height=element[0].style.height;null!=height&&""!==height&&(height=parseFloat(height.substring(0,height.length-2)),null==height||Number.isNaN(height)||timeline.height(height)),timeline.init(timelineElement),null!=scope.markerHover&&timeline.markerHover(scope.markerHover),scope.$watch("configure",function(n,o){null!=scope.configure&&scope.configure({timeline:timeline})}),scope.$watchCollection("model",function(n,o){(null!=o||null!=n)&&(timeline.data(n).redraw(),timeline.start())}),scope.$watchCollection("markers",function(n,o){(null!=o||null!=n)&&timeline.markers(n).redraw()}),scope.$watch("interval",function(n,o){(null!=o||null!=n)&&timeline.interval(n).redraw()}),scope.$watch("delay",function(n,o){(null!=o||null!=n)&&timeline.delay(n).redraw()}),scope.$watchCollection("yExtent",function(n,o){(null!=o||null!=n)&&timeline.yExtent(n).redraw()}),scope.$watch("fps",function(n,o){(null!=o||null!=n)&&timeline.fps(n)});var resizeTimer,resizeWidth=null!=attrs.sentioResizeWidth,resizeHeight=null!=attrs.sentioResizeHeight,window=angular.element($window),doResize=function(){var body=$document[0].body,overflow=body.style.overflow;body.style.overflow="hidden";var rawElement=element[0],parentWidth=rawElement.attributes.width|rawElement.style.width|rawElement.clientWidth,parentHeight=rawElement.attributes.height|rawElement.style.height|rawElement.clientHeight,width=resizeWidth?parentWidth-attrs.sentioResizeWidth:void 0,height=resizeHeight?parentHeight-attrs.sentioResizeHeight:void 0;body.style.overflow=overflow,$log.debug("resize rt.timeline height: "+height+" width: "+width),resizeWidth&&timeline.width(width),resizeHeight&&timeline.height(height),timeline.redraw()},delayResize=function(){void 0!==resizeTimer&&$timeout.cancel(resizeTimer),resizeTimer=$timeout(doResize,200)};(resizeWidth||resizeHeight)&&(window.on("resize",delayResize),delayResize()),scope.$on("$destroy",function(){window.off("resize",delayResize)}),scope.$on("$destroy",function(){timeline.stop()})}}}),angular.module("sentio").directive("sentioTimeline",function($document,$window,$timeout,$log){"use strict";return{restrict:"A",scope:{model:"=sentioModel",markers:"=sentioMarkers",yExtent:"=sentioYExtent",xExtent:"=sentioXExtent",duration:"=sentioDuration",resizeWidth:"@sentioResizeWidth",resizeHeight:"@sentioResizeHeight",configureFn:"&sentioConfigureFn",filterFn:"&sentioFilterFn"},replace:!1,link:function(scope,element,attrs,controller){var timelineElement=d3.select(element[0]),timeline=sentio.timeline.line(),width=element[0].style.width;null!=width&&""!==width&&(width=parseFloat(width.substring(0,width.length-2)),null==width||Number.isNaN(width)||timeline.width(width));var height=element[0].style.height;null!=height&&""!==height&&(height=parseFloat(height.substring(0,height.length-2)),null==height||Number.isNaN(height)||timeline.height(height)),null!=attrs.sentioFilterFn&&timeline.filter(!0),scope.$watch("filterFn",function(n,o){timeline.filter().on("filterend",function(filterState){scope.$apply(function(){scope.filterFn({filterState:filterState})})})}),timeline.init(timelineElement),scope.$watch("configureFn",function(n,o){null!=scope.configureFn&&scope.configureFn({timeline:timeline})}),scope.$watchCollection("model",function(n,o){(null!=o||null!=n)&&timeline.data(n).redraw()}),scope.$watchCollection("markers",function(n,o){(null!=o||null!=n)&&timeline.markers(n).redraw()}),scope.$watchCollection("yExtent",function(n,o){(null!=o||null!=n)&&timeline.yExtent(n).redraw()}),scope.$watchCollection("xExtent",function(n,o){(null!=o||null!=n)&&timeline.xExtent(n).redraw()}),scope.$watch("duration",function(n,o){(null!=o||null!=n)&&timeline.duration(n)},!0);var resizeTimer,resizeWidth=null!=attrs.sentioResizeWidth,resizeHeight=null!=attrs.sentioResizeHeight,window=angular.element($window),doResize=function(){var body=$document[0].body,overflow=body.style.overflow;body.style.overflow="hidden";var rawElement=element[0],parentWidth=rawElement.attributes.width|rawElement.style.width|rawElement.clientWidth,parentHeight=rawElement.attributes.height|rawElement.style.height|rawElement.clientHeight,width=resizeWidth?parentWidth-attrs.sentioResizeWidth:void 0,height=resizeHeight?parentHeight-attrs.sentioResizeHeight:void 0;body.style.overflow=overflow,$log.debug("resize rt.timeline height: "+height+" width: "+width),resizeWidth&&timeline.width(width),resizeHeight&&timeline.height(height),timeline.redraw()},delayResize=function(){void 0!==resizeTimer&&$timeout.cancel(resizeTimer),resizeTimer=$timeout(doResize,200)};(resizeWidth||resizeHeight)&&(window.on("resize",delayResize),delayResize()),scope.$on("$destroy",function(){window.off("resize",delayResize)})}}});